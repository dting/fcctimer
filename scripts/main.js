"use strict";var app=angular.module("PomodoroApp",["ngMaterial"]);app.config(function($mdThemingProvider){$mdThemingProvider.theme("default").primaryPalette("green").accentPalette("red").warnPalette("yellow")}),app.controller("AppCtrl",function($scope,$interval,Hexagons){function startTimer(){return vm.running=!0,outerHexagon.animateCountdown(vm.timeRemaining.valueOf()),$interval(function(){vm.timeRemaining.subtract(100,"ms")},100)}function stopTimer(){vm.running=!1,$interval.cancel(vm.timer),outerHexagon.stop()}function startNextTimer(){vm.currentTimer="session"===vm.currentTimer?"break":"session";var stroke="session"===vm.currentTimer?"#90a959":"#ac4142";outerHexagon.stop(),outerHexagon.attr({"stroke-dashoffset":0,stroke:stroke}),innerHexagon.attr({stroke:stroke}),vm.timeRemaining=moment.duration(vm[vm.currentTimer],"minutes"),vm.timer=startTimer()}var vm=this;vm.session=30,vm["break"]=5,vm.currentTimer="session",vm.timeRemaining=moment.duration(vm.session,"minutes"),Hexagons.create(200,200,180).attr({stroke:"#888",strokeWidth:20});var outerHexagon=Hexagons.create(200,200,180).attr({fill:"#b0b0b0",stroke:"#90a959",strokeWidth:10}),innerHexagon=Hexagons.create(200,200,100).attr({fill:"#d0d0d0",stroke:"#90a959",strokeWidth:10,opacity:.75});Hexagons.infRotate(innerHexagon),$scope.$watch("vm.session",function(newVal){vm.timeRemaining=moment.duration(newVal,"minutes")}),vm.start=function(){vm.started=!0,vm.timer=startTimer()},vm.resume=function(){vm.timer=startTimer()},vm.cancel=function(){vm.started=!1,stopTimer(),outerHexagon.attr({"stroke-dashoffset":0,stroke:"#90a959"}),innerHexagon.attr({stroke:"#90a959"}),vm.timeRemaining=moment.duration(vm.session,"minutes")},vm.pause=function(){stopTimer()};var time=Snap("#svg").text(200,225,[]).attr({"text-anchor":"middle","font-size":"50px"});$scope.$watch("vm.timeRemaining.valueOf()",function(newVal){var fmt;fmt=6e4>newVal?"ss.SS":36e5>newVal?"mm:ss":"HH:mm:ss",time.attr({text:moment.utc(newVal).format(fmt)}),newVal||(stopTimer(),$scope.$evalAsync(startNextTimer))})}),app.factory("Hexagons",function(){function hexagonPath(x,y,r){var x1=x,y1=y-r,x2=x+Math.cos(Math.PI/6)*r,y2=y-Math.sin(Math.PI/6)*r,x3=x+Math.cos(Math.PI/6)*r,y3=y+Math.sin(Math.PI/6)*r,x4=x,y4=y+r,x5=x-Math.cos(Math.PI/6)*r,y5=y+Math.sin(Math.PI/6)*r,x6=x-Math.cos(Math.PI/6)*r,y6=y-Math.sin(Math.PI/6)*r;return"M"+x1+" "+y1+" L"+x2+" "+y2+" L"+x3+" "+y3+" L"+x4+" "+y4+" L"+x5+" "+y5+" L"+x6+" "+y6+"z"}var s=Snap("#svg");return{create:function(x,y,r){var path=hexagonPath(x,y,r),loopLength=Snap.path.getTotalLength(path),hexagon=s.path({path:path,"stroke-dasharray":loopLength+" "+loopLength,"stroke-dashoffset":0});return hexagon.animateCountdown=function(timeRemaining){return hexagon.animate({"stroke-dashoffset":loopLength},timeRemaining)},hexagon},infRotate:function infRotate(el){el.transform("r0,200,200"),el.animate({transform:"r360,200,200"},6e4,mina.linear,infRotate.bind(null,el))}}});